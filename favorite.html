<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Favorites - RiceMovies</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <link rel="stylesheet" href="css/common.css">
  <link rel="stylesheet" href="css/index.css">
</head>
<body style="background-color:#000; color:white;">

  <div class="navbar">
    <a href="index.html"><div class="title">RiceMovies</div></a>
    <div>
      <a href="index.html">Discover</a>
      <a href="favorite.html" class="active">Favorites</a>
    </div>
  </div>

  <div class="container my-4">
    <h2 class="text-center mb-4">❤️ Your Favorites</h2>
    <div id="favoritesContainer" class="d-flex flex-wrap justify-content-center gap-4"></div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const container = document.getElementById("favoritesContainer");
      const favorites = JSON.parse(localStorage.getItem("favorites")) || [];

      if (favorites.length === 0) {
        container.innerHTML = `<p class="text-center" style="color:gray;">You haven’t added any favorites yet.</p>`;
        return;
      }

      favorites.forEach(item => {
        const card = document.createElement("div");
        card.className = "movie-card";
        card.style.width = "180px";
        card.style.position = "relative";
        card.style.cursor = "pointer";

        const favBtn = document.createElement("div");
        favBtn.textContent = "❤️";
        favBtn.style.position = "absolute";
        favBtn.style.top = "8px";
        favBtn.style.right = "8px";
        favBtn.style.fontSize = "22px";
        favBtn.style.cursor = "pointer";
        favBtn.style.color = "#ff3366";
        favBtn.style.userSelect = "none";

        favBtn.onclick = (e) => {
          e.stopPropagation();
          removeFavorite(item.id);
          card.remove();
          if (container.children.length === 0) {
            container.innerHTML = `<p class="text-center" style="color:gray;">You haven’t added any favorites yet.</p>`;
          }
        };

        card.innerHTML = `
          <img src="${item.poster}" alt="${item.title}" style="width:100%; border-radius:10px;" />
          <h6 style="margin-top:8px;color:white;">${item.title}</h6>
        `;
        card.prepend(favBtn);

        card.onclick = () => {
          const destination = item.type === "tv"
            ? `tv-watch.html?id=${item.id}&title=${encodeURIComponent(item.title)}&poster=${encodeURIComponent(item.poster)}&overview=&release=`
            : `watch.html?id=${item.id}&title=${encodeURIComponent(item.title)}&poster=${encodeURIComponent(item.poster)}&overview=&release=`;
          window.location.href = destination;
        };

        container.appendChild(card);
      });
    });

    function removeFavorite(id) {
      let favorites = JSON.parse(localStorage.getItem("favorites")) || [];
      favorites = favorites.filter(item => item.id !== id);
      localStorage.setItem("favorites", JSON.stringify(favorites));
    }
  </script>
</body>
</html>
